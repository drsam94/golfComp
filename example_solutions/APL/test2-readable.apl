∇Z←Y yc SR
S←7|SR
R←⌊SR÷7
A←{(0=4|⍵)∧((0<100|⍵)∨(0=400|⍵))}|Y
M←⊖(7 | (S + 12 + +\0 31 (28+A)  31 30 31 30 31 31 30 31 30 19))
Z←(1↑M)+(7×(R++/4=(1↓M))×(Y>0))
∇ 

∇Z←E ans S
Y←{(¯1+2×(⍵≥S))×⍵}(1899↓⍳E)
X←yc/⊖0,Y
Z←⌊X÷7
∇